openapi: 3.0.3
info:
  description: This API stores individual search and purchase events in a database.
  version: "1.0.0"
  title: Grocery Storage API
  contact:
    email: lvu17@my.bcit.ca

paths:
  /product/search:
  #   post:
  #     summary: Add a single search reading
  #     operationId: app.add_search_readings
  #     description: Stores one search reading in the database
  #     requestBody:
  #       required: true
  #       content:
  #         application/json:
  #           schema:
  #             $ref: '#/components/schemas/SearchReading'
  #     responses:
  #       '201':
  #         description: search reading successfully stored
  #       '400':
  #         description: invalid input, object invalid
    
    get:
      summary: gets search readings in a time range
      operationId: app.get_search_readings
      description: Gets search readings within a timespan
      parameters:
        - name: start_timestamp
          in: query
          description: Start of timespan
          schema:
            type: string
            format: date-time
            example: "2016-08-29T09:12:33.001Z"
        - name: end_timestamp
          in: query
          description: End of timespan
          schema:
            type: string
            format: date-time
            example: "2016-08-29T09:12:33.001Z"
      responses:
        '200':
          description: Successfully returned a list of search readings
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SearchReading'

  /product/sold:
    # post:
    #   summary: Add a single purchase reading
    #   operationId: app.add_purchase_readings
    #   description: Stores one purchase reading in the database
    #   requestBody:
    #     required: true
    #     content:
    #       application/json:
    #         schema:
    #           $ref: '#/components/schemas/PurchaseReading'
    #   responses:
    #     '201':
    #       description: purchase reading successfully stored
    #     '400':
    #       description: invalid input, object invalid
    
    get:
      summary: gets purchase readings in a time range
      operationId: app.get_purchase_readings
      description: Gets purchase readings within a timespan
      parameters:
        - name: start_timestamp
          in: query
          description: Start of timespan
          schema:
            type: string
            format: date-time
            example: "2016-08-29T09:12:33.001Z"
        - name: end_timestamp
          in: query
          description: End of timespan
          schema:
            type: string
            format: date-time
            example: "2016-08-29T09:12:33.001Z"
      responses:
        '200':
          description: Successfully returned a list of purchase readings
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PurchaseReading'
components:
  schemas:
    SearchReading:
      type: object
      required:
        - trace_id
        - store_id
        - store_name
        - product_id
        - search_count
        - recorded_timestamp
      properties:
        trace_id:             
          type: integer
          format: int64
          example: 1727780400000000000
        store_id:
          type: string
          format: uuid
          example: "d290f1ee-6c54-4b01-90e6-d701748f0851"
        store_name:
          type: string
          example: "Downtown Store"
        product_id:
          type: string
          example: "P12345"
        search_count:
          type: integer
          example: 15
        recorded_timestamp:
          type: string
          format: date-time
          example: "2025-08-29T09:15:33.001Z"

    PurchaseReading:
      type: object
      required:
        - trace_id
        - store_id
        - store_name
        - product_id
        - purchase_count
        - recorded_timestamp
      properties:
        trace_id:
          type: integer
          format: int64
          example: 1727780400000000000
        store_id:
          type: string
          format: uuid
          example: "d290f1ee-6c54-4b01-90e6-d701748f0851"
        store_name:
          type: string
          example: "Downtown Store"
        product_id:
          type: string
          example: "P98765"
        purchase_count:
          type: integer
          example: 3
        recorded_timestamp:
          type: string
          format: date-time
          example: "2025-08-29T09:17:45.001Z"
